<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">
    <h:head>
        <title>Update Peer Review Form</title>
    </h:head>
    
    <h:body>
        <h:outputText value="Peer Review Form for module #{lecturerPRFormBean.module.course.moduleCode}"/>
        <br/>
        <h:form id="title">
            <h:outputText value="Title: "/>
                <p:inplace id="check" editor="true">
                    <p:inputText value="#{lecturerPRFormBean.title}" required="true" label="text" />
                    <p:ajax event="save" listener="#{lecturerPRFormBean.editTitle}" update="title" />
                </p:inplace>
        </h:form>
        <br/>
        
        <h3>Individual Question</h3>
        <br />
        <p>Question for each group member</p>
        <h:panelGroup id="indNullMsg">
        <h:outputText value="No individual question created now" rendered="#{empty lecturerPRFormBean.individualQuestions}"/>
        </h:panelGroup>
        <h:form id="individual">
            <h:panelGroup id="individualQuestions">
                <ui:repeat value="#{lecturerPRFormBean.individualQuestions}" var="indQuestion" varStatus="indIndex">
                    <h:outputText value="Q#{indIndex.index+1}. "/>
                    <p:inplace id="editableIndQuestion" editor="true">
                        <p:inputText value="#{indQuestion.question}" required="true" label="text" />
                        <p:ajax event="save" listener="#{lecturerPRFormBean.editIndQuestion(indIndex.index)}" update="individual" />
                    </p:inplace>
                    <br/>
                    <p:inputTextarea id="open" rows="5" cols="30" maxlength="20000" autoResize="false" rendered="#{indQuestion.type == 'open'}"  />
                    <p:selectOneMenu id="rating"  panelStyle="width:180px" effect="fade" style="width:160px" rendered="#{indQuestion.type == 'rating'}" >
                        <f:selectItem itemLabel="Select One" itemValue="select"/>
                        <f:selectItems value="#{lecturerPRFormBean.getRating(indQuestion)}" var="rate" itemLabel="#{rate}" itemValue="#{rate}" />
                    </p:selectOneMenu>
                    <br/>
                    <p:selectOneMenu id="ranking"  panelStyle="width:180px" effect="fade" style="width:160px" rendered="#{indQuestion.type == 'ranking'}" >
                        <f:selectItem itemLabel="Select One" itemValue="select"/>
                    </p:selectOneMenu>
                    <br />
                    <p:commandButton value="delete" actionListener="#{lecturerPRFormBean.deleteIndQuestion(indIndex.index)}" update="individual indNullMsg"/>
                    <br/>
                </ui:repeat>
                <br/>
            </h:panelGroup>
        </h:form>
        
        <h3>Group Question</h3>
        <br />
        <p>Question for the whole group</p>
        <h:panelGroup id="grNullMsg">
            <h:outputText value="No group question created now" rendered="#{empty lecturerPRFormBean.groupQuestions}"/>
        </h:panelGroup>
        <h:form id ="group">
            <h:panelGroup id="groupQuestions"> 
                <ui:repeat value="#{lecturerPRFormBean.groupQuestions}" var="grQuestion" varStatus="grIndex">
                    <h:outputText value="Q#{grIndex.index+1}. "/>
                    <p:inplace id="editableIndQuestion" editor="true">
                        <p:inputText value="#{grQuestion.question}" required="true" label="text" />
                        <p:ajax event="save" listener="#{lecturerPRFormBean.editGrQuestion(indIndex.index)}" update="individual" />
                    </p:inplace>
                    <br/>
                    <p:inputTextarea rows="5" cols="30" maxlength="20000" autoResize="false" rendered="#{grQuestion.type == 'open'}" />   
                    <p:selectOneMenu id="rating"  panelStyle="width:180px" effect="fade" style="width:160px" rendered="#{grQuestion.type == 'rating'}" >
                        <f:selectItem itemLabel="Select One" itemValue="select"/>
                        <f:selectItems value="#{lecturerPRFormBean.getRating(grQuestion)}" var="rate" itemLabel="#{rate}" itemValue="#{rate}" />
                    </p:selectOneMenu>
                    <br />
                    <p:selectOneMenu id="ranking"  panelStyle="width:180px" effect="fade" style="width:160px" rendered="#{grQuestion.type == 'ranking'}" >
                        <f:selectItem itemLabel="Select One" itemValue="select"/>
                    </p:selectOneMenu>
                    <br/>
                    <p:commandButton value="delete" actionListener="#{lecturerPRFormBean.deleteGrQuestion(grIndex.index)}" update="group grNullMsg"/>
                    <br/><br/>
                </ui:repeat>
            </h:panelGroup>
            <br/>
        </h:form>
        
        <h:form id="newQuestion">
            <h3>New Question</h3>
            <h:outputText value="Enter the question:"/>
            <br/>
            <p:inputText  maxlength="2000" value="#{lecturerPRFormBean.addQuestion}" required="true" />
            <br/>
            <h:outputText value="Choose the type"/>
            <br/>
            <p:selectOneMenu value="#{lecturerPRFormBean.addType}" required="true">
                <f:selectItem itemLabel="Individual Question" itemValue="indQuestion"/>
                <f:selectItem itemLabel="Group Question" itemValue="grQuestion"/>
            </p:selectOneMenu>
            <br/>
            <h:outputText value="Choose the question type" />
            <br/>
            <p:outputPanel>
            <p:selectOneMenu value="#{lecturerPRFormBean.questionType}" required="true">
                <f:selectItem itemLabel="Open ended question" itemValue="open"/>
                <f:selectItem itemLabel="Rating question" itemValue="rating"/>
                <f:selectItem itemLabel="Ranking question" itemValue="ranking"/>
            <p:ajax process="@this" partialSubmit="true" event="change" update="level" />
            </p:selectOneMenu>
            </p:outputPanel>
            <br/>
            <p:outputPanel id="level">
                <h:outputText value="Choose the level of rating (From 1 to ?)" rendered="#{lecturerPRFormBean.questionType == 'rating'}"/>
                <br/>
                <p:selectOneMenu value="#{lecturerPRFormBean.levelOfRating}" required="true" rendered="#{lecturerPRFormBean.questionType == 'rating'}">
                    <f:selectItem itemLabel="3" itemValue="3"/>
                    <f:selectItem itemLabel="4" itemValue="4"/>
                    <f:selectItem itemLabel="5" itemValue="5"/>
                    <f:selectItem itemLabel="6" itemValue="6"/>
                    <f:selectItem itemLabel="7" itemValue="7"/>
                    <f:selectItem itemLabel="8" itemValue="8"/>
                    <f:selectItem itemLabel="9" itemValue="9"/>
                    <f:selectItem itemLabel="10" itemValue="20"/>
                </p:selectOneMenu>
            </p:outputPanel>
            <br/> 
            <p:commandButton value="add" actionListener="#{lecturerPRFormBean.addQuestion()}" update="individual group grNullMsg indNullMsg"/>
            <br/>
        </h:form>
        <p:commandButton value="reset" actionListener="#{lecturerPRFormBean.reset()}" update="title individual group grNullMsg indNullMsg"/>
    </h:body>
</html>


<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml" 
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets" 
                xmlns:h="http://xmlns.jcp.org/jsf/html" 
                xmlns:f="http://xmlns.jcp.org/jsf/core" 
                template="./layout/default.xhtml" 
                xmlns:p="http://primefaces.org/ui"
                xmlns:pe="http://primefaces.org/ui">
    <ui:define name="content">
        <h:outputStylesheet name="./css/style.css"/> 

        <div class="wrapper">
            <div class="container">

                <h:form>
                    <h2>CREATE A NEW ACCOUNT</h2>

                    <p:growl id="messages" showDetail="true" />
                    <h:panelGrid style="width: 100%" id="details" styleClass="textInput" columns="1" cellpadding="5">    

                        <p:inputText styleClass="textInput" title="6-12 alphanumeric without special characters"
                                     placeholder="username"
                                     id="username" value="#{registerBean.username}" 
                                     required="true" requiredMessage="Username required." 
                                     validatorMessage="Invalid format. Username must be between 6-12 letters/numbers. Special characters are not allowed.">
                            <f:validateRegex pattern="^[a-zA-Z0-9]{6,12}$" /> 
                        </p:inputText>                        

                        <p:password styleClass="textInput" 
                                    placeholder="password"
                                    title="6-12 characters"
                                    id="password" value="#{registerBean.password}" 
                                    feedback="true"
                                    validatorMessage="Invalid format. Password must be between 6-12 letters/numbers."
                                    required="true" requiredMessage="Password required." />

                        <p:inputText styleClass="textInput" 
                                     title="Please enter your full name"
                                     placeholder="name"
                                     id="name" value="#{registerBean.name}" 
                                     required="true" 
                                     requiredMessage="Name required." >
                        </p:inputText>                       

                        <p:inputText styleClass="textInput" 
                                     placeholder="email" 
                                     title="Please enter your email address"
                                     id="email" value="#{registerBean.email}" required="true" 
                                     requiredMessage="Email required."                                     
                                     validatorMessage="Email format is invalid.">
                        </p:inputText>

                        <p:inputText styleClass="textInput" 
                                     title="Please enter your contact number"
                                     placeholder="contact number"
                                     id="contact" value="#{registerBean.contactNum}" 
                                     required="true" requiredMessage="Contact number required." 
                                     validatorMessage="Invalid format. Contact number must be at least 8 digits">
                        </p:inputText>

                        <p:selectOneMenu styleClass="textInput" required="true" id="school" value="#{registerBean.school}" 
                                         editable="true" placeholder="school" requiredMessage="Please enter your school name or choose from the list">
                            <f:selectItem itemLabel="NUS" itemValue="NUS" />
                            <f:selectItem itemLabel="NTU" itemValue="NTU" />
                            <f:selectItem itemLabel="SMU" itemValue="SMU" />
                        </p:selectOneMenu>                                                                  


                        <p:selectOneButton styleClass="textInput" required="true" requiredMessage="Please select a user type" id="userType" value="#{registerBean.userType}">
                            <f:selectItem itemLabel="student" itemValue="1" />
                            <f:selectItem itemLabel="lecturer" itemValue="2" />
                            <f:selectItem itemLabel="guest" itemValue="3" />
                        </p:selectOneButton>


                        <p:commandButton update="@form" value="REGISTER" actionListener="#{registerBean.register}" />
                        <!--<h:commandButton value="REGISTER" actionListener="#{registerBean.register}"  > 
                        </h:commandButton>-->
                        <br></br>


                        <h:panelGrid columns="2" style="margin: auto">
                            <h:outputText value="I agree to the terms &amp; conditions"></h:outputText>
                            <p:selectBooleanCheckbox value="#{registerBean.agree}" id="terms" required="true" requiredMessage="You must agree to our Terms &amp; Conditions" >
                            </p:selectBooleanCheckbox>
                        </h:panelGrid>

                        <br></br>
                        <p:commandButton ajax="false" value="Terms &amp; Conditions">
                            <p:confirm icon="ui-icon-alert" />
                        </p:commandButton>

                        <p:confirmDialog header="Terms &amp; Conditions" global="true" showEffect="fade" hideEffect="fade">
                            <f:facet name="message">
                                <h:outputText value="PRISM will collect and store information about you." />
                                <br />
                                <h:outputText value="In accordance to PDPA, PRISM will not disclose your data without formal authorization." />
                                <br />
                                <h:outputText value="The rest of the T &amp; C is still in progress." />
                            </f:facet>
                            <p:commandButton value="Agree" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
                            <p:commandButton value="Disagree" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
                        </p:confirmDialog>


                        <p:commandButton update="messages" process="@this" action="#{registerBean.doBack}" id="backButton" value="BACK TO LOGIN" />
                        <!--<h:button value="BACK TO LOGIN" outcome="login"/>-->


                        <!--tool tips-->
                        <p:tooltip id="toolTipUser" for="username" showEvent="focus" hideEvent="blur" position="left" showEffect="clip" />
                        <p:tooltip id="toolTipPass" for="password" showEvent="focus" hideEvent="blur" position="left" showEffect="clip"/>
                        <p:tooltip id="toolTipEmail" for="email" showEvent="focus" hideEvent="blur" position="left" showEffect="clip"/>
                        <p:tooltip id="toolTipName" for="name" showEvent="focus" hideEvent="blur" position="left" showEffect="clip"/>
                        <p:tooltip id="toolTipNum" for="contact" showEvent="focus" hideEvent="blur" position="left" showEffect="clip"/>

                    </h:panelGrid>    

                </h:form>


                <br>--------------------------------------</br>

                <!--For lazy people, please delete when not needed anymore-->
                <h:form>
                    <h:commandButton value="TestRegisterStudent" actionListener="#{registerBean.testRegisterStudent}"/>

                    <h:commandButton value="TestRegisterLecturer" actionListener="#{registerBean.testRegisterLecturer}"/>

                    <h:commandButton value="TestRegisterGuest" actionListener="#{registerBean.testRegisterGuest}"/>

                    <h:commandButton value="CreateManyUsers" actionListener="#{registerBean.testusercase}"/>

                    <h:commandButton value="CreateAdmin" actionListener="#{registerBean.registerAdmin}"/>
                </h:form>
            </div>

            <ul class="bg-bubbles">
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
            </ul>
        </div>
    </ui:define>
</ui:composition>


